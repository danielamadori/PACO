# Callback Verification Matrix

This matrix maps user-facing scenarios to the underlying Dash callbacks to ensure comprehensive testing coverage.

## Scenario 1: Core Modeling (BPMN Generation)
**User Story**: User enters a process expression and generates the diagram.
- **Action**: Type [(A,B)](file:///C:/Users/Emanuele/AppData/Local/Packages/PythonSoftwareFoundation.Python.3.13_qbz5n2kfra8p0/LocalCache/local-packages/Python313/site-packages/pm4py/utils.py#311-397) + Click "Generate".
- **Primary Callback**: `Callback 11` (Controller: [evaluate_expression](file:///c:/Users/Emanuele/GithubRepo/PACO/gui/src/controller/home/sidebar/bpmn_tab/expression.py#14-83))
    - **Trigger**: `generate-bpmn-btn.n_clicks`
    - **Expected Output**: `bpmn-store`, `bpmn-svg-store`, Tables (`task-impacts`, etc.).
- **Related Callbacks**:
    - `Callback 12` (Sync Input/Store - check if this causes double updates).

## Scenario 2: Visualization Control
**User Story**: User explores the diagram using zoom and interface controls.
- **Action**: Click Zoom (+/-) on BPMN tab.
    - **Callback**: `Callback 1` (`bpmn-svg-zoom`)
- **Action**: Click Zoom (+/-) on Petri Net tab.
    - **Callback**: `Callback 2` (`petri-svg-zoom`)
- **Action**: Toggle Sidebar.
    - **Callback**: `Callback 20` (`toggle-sidebar`) -> Updates `sidebar-visible`.
    - **Callback**: `Callback 21` (Layout Update) -> Resize `split-pane`.

## Scenario 3: Simulation Workflow
**User Story**: User runs a step-by-step simulation of the process.
- **Action**: Click "Forward" (Step).
    - **Callback**: `Callback 38` (`btn-forward.n_clicks`)
    - **Inputs**: `bpmn-store`, `simulation-store`, `gateway.value`.
    - **Expected Output**: Updated `simulation-store`, `bpmn-svg` (tokens).
- **Action**: Gateway Choice (if applicable).
    - **Callback**: `Callback 34` (Random Button) or Manual Selection.
- **Action**: Simulation Updates UI.
    - **Callback**: `Callback 35` (Status Info).
    - **Callback**: `Callback 33` (Pending Decisions).

## Scenario 4: Copilot / Chat
**User Story**: User asks the AI assistant for help.
- **Action**: User sends a message.
    - **Callback**: `Callback 27` (Update chat history).
    - **Callback**: `Callback 28` (LLM Response).
    - **Callback**: `Callback 29` (Render Chat).

## Risk Analysis
- **High Risk**: `Callback 11` (God Callback) and `Callback 38` (Simulation Logic). Failures here break the core app.
- **Medium Risk**: `Callback 28` (Chat) - External dependency (API).
